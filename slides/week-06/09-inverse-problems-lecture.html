<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.27">

  <meta name="author" content="Felix J. Herrmann">
  <meta name="dcterms.date" content="2026-02-16">
  <title>Seismic Exploration Methods ‚Äì Inverse Problems</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-832775eafbd512325564c8c290c39367.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="../../site_libs/quarto-diagram/mermaid.min.js"></script>
  <script src="../../site_libs/quarto-diagram/mermaid-init.js"></script>
  <link href="../../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Inverse Problems</h1>
  <p class="subtitle">From Forward Modeling to Regularized Inversion in Exploration Seismology</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Felix J. Herrmann 
</div>
        <p class="quarto-title-affiliation">
            School of Earth &amp; Atmospheric Sciences ‚Äî Georgia Institute of Technology
          </p>
    </div>
</div>

  <p class="date">2026-02-16</p>
</section>
<section id="outline" class="slide level2 smaller">
<h2>Outline</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Part I ‚Äî Foundations</strong></p>
<ul>
<li>Forward &amp; inverse problems</li>
<li>Linear forward problem</li>
<li>Strict inverse for invertible systems</li>
<li>When the inverse does not exist</li>
</ul>
<p><strong>Part II ‚Äî Least-Squares Inversion</strong></p>
<ul>
<li>Least-squares formulation</li>
<li>Normal equations</li>
<li>Non-uniqueness &amp; minimum-norm solutions</li>
</ul>
</div><div class="column" style="width:50%;">
<p><strong>Part III ‚Äî SVD &amp; Generalized Inverses</strong></p>
<ul>
<li>Singular Value Decomposition</li>
<li>Fundamental subspaces</li>
<li>Pseudo-inverse &amp; four cases</li>
</ul>
<p><strong>Part IV ‚Äî Regularization</strong></p>
<ul>
<li>Condition number &amp; ill-posedness</li>
<li>Truncated SVD</li>
<li>Tikhonov regularization</li>
<li>Bayesian interpretation</li>
</ul>
<p><strong>Part V ‚Äî Application</strong></p>
<ul>
<li>Deconvolution as an inverse problem</li>
<li>Numerical examples in Julia</li>
</ul>
</div></div>
</section>
<section>
<section id="part-i-foundations" class="title-slide slide level1 center" data-background-color="#2c3e50">
<h1>Part I ‚Äî Foundations</h1>

</section>
<section id="the-forward-problem" class="slide level2">
<h2>The Forward Problem</h2>
<p>In exploration seismology, we relate <strong>model parameters</strong> <span class="math inline">\(\mathbf{m}\)</span> (e.g., velocity, density, reflectivity) to <strong>observed data</strong> <span class="math inline">\(\mathbf{d}\)</span> (e.g., seismograms) through a forward operator:</p>
<p><span class="math display">\[
\mathbf{d} = F(\mathbf{m})
\]</span></p>
<p>where <span class="math inline">\(F : \mathbb{R}^M \to \mathbb{R}^N\)</span> maps from model space to data space.</p>
<div class="fragment">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Key distinction</strong></p>
</div>
<div class="callout-content">
<p>The <strong>forward problem</strong> ‚Äî given <span class="math inline">\(\mathbf{m}\)</span>, compute <span class="math inline">\(\mathbf{d}\)</span> ‚Äî is typically well-posed. The <strong>inverse problem</strong> ‚Äî given <span class="math inline">\(\mathbf{d}\)</span>, recover <span class="math inline">\(\mathbf{m}\)</span> ‚Äî is typically ill-posed.</p>
</div>
</div>
</div>
</div>
</section>
<section id="forward-problem-examples" class="slide level2">
<h2>Forward Problem ‚Äî Examples</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Forward Operator</th>
<th style="text-align: left;">Model <span class="math inline">\(\mathbf{m}\)</span></th>
<th style="text-align: left;">Data <span class="math inline">\(\mathbf{d}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Wave equation</td>
<td style="text-align: left;">Velocity field</td>
<td style="text-align: left;">Seismograms</td>
</tr>
<tr class="even">
<td style="text-align: left;">Born approximation</td>
<td style="text-align: left;">Reflectivity</td>
<td style="text-align: left;">Scattered wavefield</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Convolution</td>
<td style="text-align: left;">Reflectivity series</td>
<td style="text-align: left;">Seismic trace</td>
</tr>
</tbody>
</table>
<div class="fragment">
<p>All share the common mathematical structure <span class="math inline">\(\mathbf{d} = F(\mathbf{m})\)</span>.</p>
</div>
</section>
<section id="the-linear-forward-problem" class="slide level2 smaller">
<h2>The Linear Forward Problem</h2>
<p>When <span class="math inline">\(F\)</span> is <strong>linear</strong>, we write</p>
<p><span class="math display">\[
\mathbf{d} = \mathbf{A}\,\mathbf{m}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{A} \in \mathbb{R}^{N \times M}\)</span> is the forward modeling matrix.</p>
<div class="fragment">
<p><strong>Linearity</strong> means:</p>
<ul>
<li><span class="math inline">\(F(\alpha\,\mathbf{m}_1 + \beta\,\mathbf{m}_2) = \alpha\,F(\mathbf{m}_1) + \beta\,F(\mathbf{m}_2)\)</span></li>
</ul>
</div>
<div class="fragment">
<p><strong>Linearization</strong> of nonlinear problems:</p>
<p><span class="math display">\[
F(\mathbf{m}_0 + \delta\mathbf{m}) \approx F(\mathbf{m}_0) + \underbrace{\frac{\partial F}{\partial \mathbf{m}}\bigg|_{\mathbf{m}_0}}_{\mathbf{A}}\,\delta\mathbf{m}
\]</span></p>
<p>When <span class="math inline">\(F(\mathbf{m}\)</span> is the solution of the wave equation, this is the</p>
<ul>
<li>single-scattering <strong>Born approximation</strong> ‚Äî the Jacobian <span class="math inline">\(\mathbf{A}\)</span> is the Fr√©chet derivative.</li>
<li>The vector <span class="math inline">\(\mathbf{m}_0\)</span> is a smooth (non-reflecting) background-velocity model.</li>
</ul>
</div>
</section>
<section id="forward-inverse-nonlinear-vs.-linear" class="slide level2 smaller">
<h2>Forward &amp; Inverse: Nonlinear vs.&nbsp;Linear</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Nonlinear forward</strong></p>
<p><span class="math display">\[\mathbf{d} = F(\mathbf{m})\]</span></p>
<p><strong>Nonlinear inverse</strong></p>
<p><span class="math display">\[\mathbf{m} = F^{-1}(\mathbf{d})\]</span></p>
<p>Solved iteratively ‚Äî e.g., Gauss‚ÄìNewton, gradient descent.</p>
</div><div class="column" style="width:50%;">
<p><strong>Linear forward</strong></p>
<p><span class="math display">\[\mathbf{d} = \mathbf{A}\,\mathbf{m}\]</span></p>
<p><strong>Linear inverse</strong></p>
<p><span class="math display">\[\mathbf{m} = \mathbf{A}^{-1}\,\mathbf{d}\]</span></p>
<p>But does <span class="math inline">\(\mathbf{A}^{-1}\)</span> exist?</p>
</div></div>
<div class="fragment">
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p>Even when <span class="math inline">\(\mathbf{A}^{-1}\)</span> exists, computing it may be <strong>numerically unstable</strong>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="the-strict-inverse" class="slide level2 smaller">
<h2>The Strict Inverse</h2>
<p>If <span class="math inline">\(\mathbf{A}\)</span> is square (<span class="math inline">\(N = M\)</span>) and <strong>invertible</strong> (<span class="math inline">\(\det(\mathbf{A}) \neq 0\)</span>), the exact inverse exists:</p>
<p><span class="math display">\[
\mathbf{m} = \mathbf{A}^{-1}\,\mathbf{d}
\]</span></p>
<div class="fragment">
<p><strong>Properties:</strong></p>
<ul>
<li><span class="math inline">\(\mathbf{A}\,\mathbf{A}^{-1} = \mathbf{A}^{-1}\,\mathbf{A} = \mathbf{I}\)</span></li>
<li>Unique solution for every <span class="math inline">\(\mathbf{d}\)</span></li>
</ul>
</div>
<div class="fragment">
<p><strong>Orthogonal matrices</strong> satisfy <span class="math inline">\(\mathbf{A}^\top\mathbf{A} = \mathbf{A}\,\mathbf{A}^\top = \mathbf{I}\)</span>, so the adjoint <em>is</em> the inverse.</p>
<p><strong>In practice, this situation is rare</strong> because:</p>
<ul>
<li><span class="math inline">\(N \neq M\)</span> (more data than unknowns or vice versa)</li>
<li><span class="math inline">\(\mathbf{A}\)</span> may be rank-deficient</li>
<li>Noise contaminates the data</li>
</ul>
</div>
</section>
<section id="when-does-the-inverse-not-exist" class="slide level2">
<h2>When Does the Inverse Not Exist?</h2>
<p>Three scenarios arise:</p>
<div class="fragment">
<p><strong>1. Overdetermined</strong> (<span class="math inline">\(N &gt; M\)</span>): more equations than unknowns ‚Äî no exact solution in general.</p>
</div>
<div class="fragment">
<p><strong>2. Underdetermined</strong> (<span class="math inline">\(N &lt; M\)</span>): fewer equations than unknowns ‚Äî infinitely many solutions.</p>
</div>
<div class="fragment">
<p><strong>3. Rank-deficient</strong> (<span class="math inline">\(\text{rank}(\mathbf{A}) &lt; \min(N,M)\)</span>): even with <span class="math inline">\(N = M\)</span>, rows/columns are linearly dependent.</p>
</div>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>In seismology, we almost always face some combination of these ‚Äî the inverse problem is <strong>ill-posed</strong>.</p>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="part-ii-least-squares-inversion" class="title-slide slide level1 center" data-background-color="#2c3e50">
<h1>Part II ‚Äî Least-Squares Inversion</h1>

</section>
<section id="least-squares-formulation" class="slide level2">
<h2>Least-Squares Formulation</h2>
<p>When no exact solution exists, we seek the model that best fits the data in a least-squares sense:</p>
<p><span class="math display">\[
\min_{\mathbf{m}} \;\; J(\mathbf{m}) = \frac{1}{2}\|\mathbf{A}\,\mathbf{m} - \mathbf{d}\|_2^2
\]</span></p>
<div class="fragment">
<p>Expanding:</p>
<p><span class="math display">\[
J(\mathbf{m}) = \frac{1}{2}\left(\mathbf{A}\,\mathbf{m} - \mathbf{d}\right)^\top\left(\mathbf{A}\,\mathbf{m} - \mathbf{d}\right)
\]</span></p>
<p><span class="math display">\[
= \frac{1}{2}\left(\mathbf{m}^\top\mathbf{A}^\top\mathbf{A}\,\mathbf{m} - 2\,\mathbf{m}^\top\mathbf{A}^\top\mathbf{d} + \mathbf{d}^\top\mathbf{d}\right)
\]</span></p>
</div>
</section>
<section id="normal-equations" class="slide level2 smaller">
<h2>Normal Equations</h2>
<p>Setting the gradient to zero:</p>
<p><span class="math display">\[
\nabla_{\mathbf{m}} J = \mathbf{A}^\top\mathbf{A}\,\mathbf{m} - \mathbf{A}^\top\mathbf{d} = \mathbf{0}
\]</span></p>
<div class="fragment">
<p>yields the <strong>normal equations</strong>:</p>
<p><span class="math display">\[
\boxed{\mathbf{A}^\top\mathbf{A}\,\mathbf{m} = \mathbf{A}^\top\mathbf{d}}
\]</span></p>
</div>
<div class="fragment">
<p>If <span class="math inline">\(\mathbf{A}^\top\mathbf{A}\)</span> is invertible, the <strong>least-squares solution</strong> is:</p>
<p><span class="math display">\[
\hat{\mathbf{m}}_{\text{LS}} = \left(\mathbf{A}^\top\mathbf{A}\right)^{-1}\mathbf{A}^\top\,\mathbf{d}
\]</span></p>
</div>
<div class="fragment">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p><span class="math inline">\(\mathbf{A}^\top\)</span> is the transpose of the matrix <span class="math inline">\(\mathbf{A}\)</span>. <span class="math inline">\(\mathbf{A}^\top\mathbf{A}\)</span> is the <strong>Gram matrix</strong> ‚Äî symmetric positive semi-definite, and positive definite iff <span class="math inline">\(\mathbf{A}\)</span> has full column rank.</p>
</div>
</div>
</div>
</div>
</section>
<section id="transpose-and-adjoint" class="slide level2">
<h2>Transpose and Adjoint</h2>
<p>The <strong>adjoint</strong> (or <strong>transpose</strong> for real-valued matrices) <span class="math inline">\(\mathbf{A}^H\)</span> satisfies:</p>
<p><span class="math display">\[
\langle \mathbf{A}\,\mathbf{m},\, \mathbf{d} \rangle_{\mathbb{R}^N} = \langle \mathbf{m},\, \mathbf{A}^H\mathbf{d} \rangle_{\mathbb{R}^M}
\]</span></p>
<div class="fragment">
<p><strong>Physical interpretation in seismology:</strong></p>
<ul>
<li><span class="math inline">\(\mathbf{A}\)</span> = forward modeling (sources ‚Üí receivers)</li>
<li><span class="math inline">\(\mathbf{A}^\top\)</span> = migration / backprojection (receivers ‚Üí model)</li>
</ul>
</div>
<div class="fragment">
<p><strong>Unitary matrices</strong> satisfy <span class="math inline">\(\mathbf{A}^H\mathbf{A} = \mathbf{A}\,\mathbf{A}^H = \mathbf{I}\)</span>, so the adjoint <em>is</em> the inverse.</p>
<p>Example: the DFT matrix (up to a scaling factor).</p>
</div>
</section>
<section id="non-uniqueness" class="slide level2">
<h2>Non-Uniqueness</h2>
<p>A solution is <strong>non-unique</strong> when there exist distinct models <span class="math inline">\(\mathbf{m}_1 \neq \mathbf{m}_2\)</span> such that</p>
<p><span class="math display">\[
\mathbf{A}\,\mathbf{m}_1 = \mathbf{A}\,\mathbf{m}_2 = \mathbf{d}
\]</span></p>
<div class="fragment">
<p>Equivalently, <span class="math inline">\(\mathbf{A}(\mathbf{m}_1 - \mathbf{m}_2) = \mathbf{0}\)</span>, i.e., the <strong>null space</strong> <span class="math inline">\(\mathcal{N}(\mathbf{A})\)</span> is nontrivial.</p>
</div>
<div class="fragment">
<p>If <span class="math inline">\(\hat{\mathbf{m}}\)</span> is any solution, then <span class="math inline">\(\hat{\mathbf{m}} + \mathbf{m}_0\)</span> is also a solution for any <span class="math inline">\(\mathbf{m}_0 \in \mathcal{N}(\mathbf{A})\)</span>.</p>
</div>
<div class="fragment">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p><strong>Non-uniqueness is fundamental in seismology</strong> ‚Äî limited acquisition geometry means parts of the model are invisible to the data.</p>
</div>
</div>
</div>
</div>
</section>
<section id="minimum-norm-solution" class="slide level2">
<h2>Minimum-Norm Solution</h2>
<p>Among all solutions, select the one with <strong>smallest norm</strong>:</p>
<p><span class="math display">\[
\min_{\mathbf{m}} \;\; \|\mathbf{m}\|_2^2 \quad \text{subject to} \quad \mathbf{A}\,\mathbf{m} = \mathbf{d}
\]</span></p>
<div class="fragment">
<p>Using Lagrange multipliers, the <strong>minimum-norm solution</strong> is:</p>
<p><span class="math display">\[
\hat{\mathbf{m}}_{\text{MN}} = \mathbf{A}^\top\left(\mathbf{A}\,\mathbf{A}^\top\right)^{-1}\mathbf{d}
\]</span></p>
</div>
<div class="fragment">
<p>This solution:</p>
<ul>
<li>Lives entirely in the <strong>row space</strong> of <span class="math inline">\(\mathbf{A}\)</span></li>
<li>Has no component in the null space</li>
<li>Is unique among all solutions</li>
</ul>
</div>
</section>
<section id="section" class="slide level2 smaller">
<h2></h2>
<p>Any vector <span class="math inline">\(\mathbf{m} \in \mathbb{R}^M\)</span> can be decomposed uniquely using the orthogonal decomposition of the model space:</p>
<p><span class="math display">\[\mathbf{m} = \underbrace{\mathbf{m}_r}_{\in \mathcal{R}(\mathbf{A}^\top)} + \underbrace{\mathbf{m}_0}_{\in \mathcal{N}(\mathbf{A})}\]</span></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(\mathcal{R}(\mathbf{A})\)</span> denotes the <strong>range</strong> (or column space) of <span class="math inline">\(\mathbf{A}\)</span> ‚Äî the set of all vectors that can be written as <span class="math inline">\(\mathbf{A}\mathbf{m}\)</span> for some <span class="math inline">\(\mathbf{m}\)</span>.</p></li>
<li><p><span class="math inline">\(\mathcal{N}(\mathbf{A})\)</span> is the <strong>null space</strong> (or kernel) of <span class="math inline">\(\mathbf{A}\)</span> ‚Äî the set of all vectors that <span class="math inline">\(\mathbf{A}\)</span> maps to zero:</p>
<p><span class="math display">\[\mathcal{N}(\mathbf{A}) = \{\mathbf{m} \in \mathbb{R}^M : \mathbf{A}\mathbf{m} = \mathbf{0}\}\]</span></p>
<p>These are the model components that produce no data whatsoever. In seismology, think of structure in the subsurface that your acquisition geometry simply cannot see ‚Äî it‚Äôs there, but it generates no response at the receivers.</p></li>
</ul>
<p>The notation parallels <span class="math inline">\(\mathcal{R}\)</span>: where <span class="math inline">\(\mathcal{R}(\mathbf{A})\)</span> collects everything <span class="math inline">\(\mathbf{A}\)</span> <em>can</em> produce, <span class="math inline">\(\mathcal{N}(\mathbf{A})\)</span> collects everything <span class="math inline">\(\mathbf{A}\)</span> <em>annihilates</em>.</p>
</section>
<section id="section-1" class="slide level2 smaller">
<h2></h2>
<p>Since <span class="math inline">\(\mathbf{A}\mathbf{m}_0 = \mathbf{0}\)</span> by definition of the null space, the constraint <span class="math inline">\(\mathbf{A}\mathbf{m} = \mathbf{d}\)</span> only sees the row-space component:</p>
<p><span class="math display">\[\mathbf{A}\mathbf{m} = \mathbf{A}\mathbf{m}_r + \mathbf{A}\mathbf{m}_0 = \mathbf{A}\mathbf{m}_r = \mathbf{d}\]</span></p>
<p>So the null-space component <span class="math inline">\(\mathbf{m}_0\)</span> is invisible to the data ‚Äî it‚Äôs a free parameter. Now look at what it does to the norm. Because the two components are orthogonal:</p>
<p><span class="math display">\[\|\mathbf{m}\|_2^2 = \|\mathbf{m}_r\|_2^2 + \|\mathbf{m}_0\|_2^2\]</span></p>
<p>The first term is fixed (determined by the constraint), and the second term is non-negative. The minimum is achieved when <span class="math inline">\(\mathbf{m}_0 = \mathbf{0}\)</span>, which means the solution lives entirely in <span class="math inline">\(\mathcal{R}(\mathbf{A}^\top)\)</span>.</p>
<p>You can also see this directly from the solution formula <span class="math inline">\(\hat{\mathbf{m}} = \mathbf{A}^\top(\mathbf{A}\mathbf{A}^\top)^{-1}\mathbf{d}\)</span>. The leading <span class="math inline">\(\mathbf{A}^\top\)</span> guarantees the result is a linear combination of rows of <span class="math inline">\(\mathbf{A}\)</span>, i.e., it lives in the row space by construction.</p>
</section></section>
<section>
<section id="part-iii-svd-generalized-inverses" class="title-slide slide level1 center" data-background-color="#2c3e50">
<h1>Part III ‚Äî SVD &amp; Generalized Inverses</h1>

</section>
<section id="singular-value-decomposition-svd" class="slide level2">
<h2>Singular Value Decomposition (SVD)</h2>
<p>Any matrix <span class="math inline">\(\mathbf{A} \in \mathbb{R}^{N \times M}\)</span> admits the factorization:</p>
<p><span class="math display">\[
\mathbf{A} = \mathbf{U}\,\boldsymbol{\Sigma}\,\mathbf{V}^\top
\]</span></p>
<div class="fragment">
<p>where:</p>
<ul>
<li><span class="math inline">\(\mathbf{U} \in \mathbb{R}^{N \times N}\)</span>: orthonormal columns = <strong>left singular vectors</strong> (data space)</li>
<li><span class="math inline">\(\mathbf{V} \in \mathbb{R}^{M \times M}\)</span>: orthonormal columns = <strong>right singular vectors</strong> (model space)</li>
<li><span class="math inline">\(\boldsymbol{\Sigma} \in \mathbb{R}^{N \times M}\)</span>: diagonal with <strong>singular values</strong> <span class="math inline">\(\sigma_1 \geq \sigma_2 \geq \cdots \geq \sigma_r &gt; 0\)</span></li>
<li><span class="math inline">\(r = \text{rank}(\mathbf{A})\)</span></li>
</ul>
</div>
</section>
<section id="svd-compact-form" class="slide level2">
<h2>SVD ‚Äî Compact Form</h2>
<p>Writing only the nonzero singular values:</p>
<p><span class="math display">\[
\mathbf{A} = \sum_{i=1}^{r} \sigma_i\,\mathbf{u}_i\,\mathbf{v}_i^\top
\]</span></p>
<div class="fragment">
<p>This is an <strong>outer-product expansion</strong> ‚Äî each term is a rank-1 matrix weighted by <span class="math inline">\(\sigma_i\)</span>.</p>
</div>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Computational note</strong></p>
</div>
<div class="callout-content">
<p>We rarely form <span class="math inline">\(\mathbf{A}\)</span> explicitly in seismology. We work with <span class="math inline">\(\mathbf{A}\,\mathbf{v}\)</span> (forward) and <span class="math inline">\(\mathbf{A}^\top\mathbf{u}\)</span> (adjoint/migration) as matrix-free operations.</p>
</div>
</div>
</div>
</div>
</section>
<section id="the-four-fundamental-subspaces" class="slide level2 smaller">
<h2>The Four Fundamental Subspaces</h2>
<p>The SVD reveals the <strong>four fundamental subspaces</strong> of <span class="math inline">\(\mathbf{A}\)</span> (Strang):</p>
<table class="caption-top">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Subspace</th>
<th style="text-align: left;">Basis</th>
<th style="text-align: left;">Dimension</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Column space <span class="math inline">\(\mathcal{R}(\mathbf{A})\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\{\mathbf{u}_1, \ldots, \mathbf{u}_r\}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(r\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Left null space <span class="math inline">\(\mathcal{N}(\mathbf{A}^\top)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\{\mathbf{u}_{r+1}, \ldots, \mathbf{u}_N\}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(N - r\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Row space <span class="math inline">\(\mathcal{R}(\mathbf{A}^\top)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\{\mathbf{v}_1, \ldots, \mathbf{v}_r\}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(r\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Null space <span class="math inline">\(\mathcal{N}(\mathbf{A})\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\{\mathbf{v}_{r+1}, \ldots, \mathbf{v}_M\}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(M - r\)</span></td>
</tr>
</tbody>
</table>
<div class="fragment">
<p><strong>Orthogonal decompositions:</strong></p>
<p><span class="math display">\[
\mathbb{R}^N = \mathcal{R}(\mathbf{A}) \oplus \mathcal{N}(\mathbf{A}^\top), \qquad \mathbb{R}^M = \mathcal{R}(\mathbf{A}^\top) \oplus \mathcal{N}(\mathbf{A})
\]</span></p>
</div>
</section>
<section id="the-fundamental-theorem-of-linear-algebra" class="slide level2">
<h2>The Fundamental Theorem of Linear Algebra</h2>
<div style="transform: scale(1.4); transform-origin: top center; margin-top: 0.5em;">
<div class="cell" data-reveal="true" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    subgraph Model["Model Space ‚Ñù·¥π"]
        RS["Row Space&lt;br/&gt;ùì°(A·µÄ)&lt;br/&gt;dim = r"]
        NS["Null Space&lt;br/&gt;ùìù(A)&lt;br/&gt;dim = M‚àír"]
    end
    subgraph Data["Data Space ‚Ñù·¥∫"]
        CS["Column Space&lt;br/&gt;ùì°(A)&lt;br/&gt;dim = r"]
        LNS["Left Null Space&lt;br/&gt;ùìù(A·µÄ)&lt;br/&gt;dim = N‚àír"]
    end
    RS --&gt;|"A"| CS
    CS --&gt;|"A·µÄ"| RS
    NS -.-&gt;|"A ‚Üí 0"| LNS
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
</section>
<section id="the-moorepenrose-pseudo-inverse" class="slide level2 smaller">
<h2>The Moore‚ÄìPenrose Pseudo-Inverse</h2>
<p>The <strong>pseudo-inverse</strong> <span class="math inline">\(\mathbf{A}^{\dagger}\)</span> is defined via the SVD:</p>
<p><span class="math display">\[
\mathbf{A}^{\dagger} = \mathbf{V}\,\boldsymbol{\Sigma}^{\dagger}\,\mathbf{U}^\top
\]</span></p>
<p>where <span class="math inline">\(\boldsymbol{\Sigma}^{\dagger}\)</span> inverts the nonzero singular values: <span class="math inline">\(\sigma_i^{\dagger} = 1/\sigma_i\)</span> for <span class="math inline">\(i = 1,\ldots,r\)</span> and zero otherwise.</p>
<p>. . . <span class="math inline">\(\mathcal{N}(\mathbf{A})\)</span> is the <strong>null space</strong> (or kernel) of <span class="math inline">\(\mathbf{A}\)</span> ‚Äî the set of all vectors that <span class="math inline">\(\mathbf{A}\)</span> maps to zero:</p>
<p><span class="math display">\[\mathcal{N}(\mathbf{A}) = \{\mathbf{m} \in \mathbb{R}^M : \mathbf{A}\mathbf{m} = \mathbf{0}\}\]</span></p>
<p>These are the model components that produce no data whatsoever. In seismology, think of structure in the subsurface that your acquisition geometry simply cannot see ‚Äî it‚Äôs there, but it generates no response at the receivers.</p>
<p>The notation parallels <span class="math inline">\(\mathcal{R}\)</span>: where <span class="math inline">\(\mathcal{R}(\mathbf{A})\)</span> collects everything <span class="math inline">\(\mathbf{A}\)</span> <em>can</em> produce, <span class="math inline">\(\mathcal{N}(\mathbf{A})\)</span> collects everything <span class="math inline">\(\mathbf{A}\)</span> <em>annihilates</em>. Some texts write <span class="math inline">\(\text{Ker}(\mathbf{A})\)</span> instead (from the German <em>Kern</em>). <strong>Explicitly:</strong></p>
<p><span class="math display">\[
\mathbf{A}^{\dagger} = \sum_{i=1}^{r} \frac{1}{\sigma_i}\,\mathbf{v}_i\,\mathbf{u}_i^\top
\]</span></p>
</section>
<section id="four-cases-of-the-pseudo-inverse" class="slide level2 smaller">
<h2>Four Cases of the Pseudo-Inverse</h2>
<table class="caption-top">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Case</th>
<th style="text-align: left;">Condition</th>
<th style="text-align: left;">Pseudo-inverse</th>
<th style="text-align: left;">Solution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Square, full rank</td>
<td style="text-align: left;"><span class="math inline">\(N = M = r\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\mathbf{A}^{\dagger} = \mathbf{A}^{-1}\)</span></td>
<td style="text-align: left;">Exact</td>
</tr>
<tr class="even">
<td style="text-align: left;">Overdetermined, full col.&nbsp;rank</td>
<td style="text-align: left;"><span class="math inline">\(N &gt; M = r\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\mathbf{A}^{\dagger} = (\mathbf{A}^\top\mathbf{A})^{-1}\mathbf{A}^\top\)</span></td>
<td style="text-align: left;">Least-squares</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Underdetermined, full row rank</td>
<td style="text-align: left;"><span class="math inline">\(N &lt; M,\; N = r\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\mathbf{A}^{\dagger} = \mathbf{A}^\top(\mathbf{A}\mathbf{A}^\top)^{-1}\)</span></td>
<td style="text-align: left;">Minimum-norm</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rank-deficient</td>
<td style="text-align: left;"><span class="math inline">\(r &lt; \min(N,M)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\mathbf{A}^{\dagger} = \mathbf{V}_r\boldsymbol{\Sigma}_r^{-1}\mathbf{U}_r^\top\)</span></td>
<td style="text-align: left;">Min-norm LS</td>
</tr>
</tbody>
</table>
<div class="fragment">
<p>The pseudo-inverse always gives the <strong>minimum-norm least-squares solution</strong>:</p>
<p><span class="math display">\[\hat{\mathbf{m}} = \mathbf{A}^{\dagger}\mathbf{d} = \arg\min_{\mathbf{m}} \|\mathbf{m}\|_2 \quad \text{s.t.} \quad \|\mathbf{A}\mathbf{m} - \mathbf{d}\|_2 = \min\]</span></p>
<!-- 
$$
\hat{\mathbf{m}} = \mathbf{A}^{\dagger}\,\mathbf{d} = \arg\min_{\mathbf{m}} \|\mathbf{m}\|_2 \;\;\text{s.t.}\;\; \mathbf{m} \in \arg\min \|\mathbf{A}\mathbf{m} - \mathbf{d}\|_2
$$ -->
</div>
</section>
<section id="over--underdetermined-systems" class="slide level2">
<h2>Over- &amp; Underdetermined Systems</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Overdetermined</strong> (<span class="math inline">\(N &gt; M\)</span>)</p>
<ul>
<li>More data than unknowns</li>
<li>Noise-free: may be inconsistent</li>
<li>With noise: least-squares solution</li>
</ul>
<p><span class="math display">\[
\hat{\mathbf{m}} = (\mathbf{A}^\top\mathbf{A})^{-1}\mathbf{A}^\top\mathbf{d}
\]</span></p>
<p><em>Seismic example:</em> least-squares migration.</p>
</div><div class="column" style="width:50%;">
<p><strong>Underdetermined</strong> (<span class="math inline">\(N &lt; M\)</span>)</p>
<ul>
<li>Fewer data than unknowns</li>
<li>Infinitely many solutions</li>
<li>Minimum-norm solution</li>
</ul>
<p><span class="math display">\[
\hat{\mathbf{m}} = \mathbf{A}^\top(\mathbf{A}\mathbf{A}^\top)^{-1}\mathbf{d}
\]</span></p>
<p><em>Seismic example:</em> Wavefield reconstruction from undersampled data.</p>
</div></div>
</section></section>
<section>
<section id="part-iv-regularization" class="title-slide slide level1 center" data-background-color="#2c3e50">
<h1>Part IV ‚Äî Regularization</h1>

</section>
<section id="condition-number-ill-posedness" class="slide level2 smaller">
<h2>Condition Number &amp; Ill-Posedness</h2>
<p>The <strong>condition number</strong> of <span class="math inline">\(\mathbf{A}\)</span> is:</p>
<p><span class="math display">\[
\kappa(\mathbf{A}) = \frac{\sigma_1}{\sigma_r}
\]</span></p>
<div class="fragment">
<ul>
<li><span class="math inline">\(\kappa \approx 1\)</span>: <strong>well-conditioned</strong> ‚Äî small data perturbations cause small model perturbations</li>
<li><span class="math inline">\(\kappa \gg 1\)</span>: <strong>ill-conditioned</strong> ‚Äî small data errors get amplified</li>
</ul>
</div>
<div class="fragment">
<p><strong>Hadamard‚Äôs conditions for well-posedness:</strong></p>
<ol type="1">
<li>A solution <strong>exists</strong></li>
<li>The solution is <strong>unique</strong></li>
<li>The solution depends <strong>continuously</strong> on the data</li>
</ol>
<p>Most seismic inverse problems violate conditions 2 and/or 3.</p>
</div>
</section>
<section id="why-seismic-inversion-is-ill-posed" class="slide level2 smaller">
<h2>Why Seismic Inversion Is Ill-Posed</h2>
<p><strong>Limited bandwidth</strong> ‚Äî seismic sources have bandpass character:</p>
<ul>
<li>Missing low frequencies ‚Üí non-uniqueness in long wavelengths</li>
<li>Missing high frequencies ‚Üí limited resolution</li>
</ul>
<div class="fragment">
<p><strong>Limited aperture</strong> ‚Äî finite acquisition geometry:</p>
<ul>
<li>Illumination gaps in the subsurface</li>
<li>Null-space components invisible to the data</li>
</ul>
</div>
<div class="fragment">
<p><strong>Noise</strong> ‚Äî ambient, coherent, and acquisition noise:</p>
<ul>
<li>Amplified through inversion of small singular values</li>
</ul>
</div>
</section>
<section id="effect-of-noise-on-inversion" class="slide level2">
<h2>Effect of Noise on Inversion</h2>
<p>With noisy data <span class="math inline">\(\mathbf{d} = \mathbf{A}\mathbf{m}_{\text{true}} + \mathbf{n}\)</span>, the naive pseudo-inverse gives:</p>
<p><span class="math display">\[
\hat{\mathbf{m}} = \mathbf{A}^{\dagger}\mathbf{d} = \sum_{i=1}^{r}\frac{\mathbf{u}_i^\top\mathbf{d}}{\sigma_i}\,\mathbf{v}_i
\]</span></p>
<div class="fragment">
<p><span class="math display">\[
= \underbrace{\sum_{i=1}^{r}\frac{\mathbf{u}_i^\top\mathbf{A}\mathbf{m}_{\text{true}}}{\sigma_i}\mathbf{v}_i}_{\text{signal}} + \underbrace{\sum_{i=1}^{r}\frac{\mathbf{u}_i^\top\mathbf{n}}{\sigma_i}\mathbf{v}_i}_{\text{amplified noise}}
\]</span></p>
</div>
<div class="fragment">
<p>For small <span class="math inline">\(\sigma_i\)</span>, the noise terms <span class="math inline">\(\mathbf{u}_i^\top\mathbf{n}/\sigma_i\)</span> <strong>blow up</strong>.</p>
</div>
</section>
<section id="truncated-svd-tsvd" class="slide level2">
<h2>Truncated SVD (TSVD)</h2>
<p>Regularize by keeping only the <span class="math inline">\(p &lt; r\)</span> largest singular values:</p>
<p><span class="math display">\[
\hat{\mathbf{m}}_{\text{TSVD}} = \sum_{i=1}^{p} \frac{\mathbf{u}_i^\top\mathbf{d}}{\sigma_i}\,\mathbf{v}_i
\]</span></p>
<div class="fragment">
<p><strong>Trade-off:</strong> choosing <span class="math inline">\(p\)</span></p>
<ul>
<li><span class="math inline">\(p\)</span> large ‚Üí better resolution but more noise amplification</li>
<li><span class="math inline">\(p\)</span> small ‚Üí more stable but loss of detail</li>
</ul>
</div>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>The Picard condition helps determine where to truncate: <span class="math inline">\(|\mathbf{u}_i^\top\mathbf{d}|\)</span> should decay faster than <span class="math inline">\(\sigma_i\)</span>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="tikhonov-regularization" class="slide level2 smaller">
<h2>Tikhonov Regularization</h2>
<p>Add a penalty term to the least-squares objective:</p>
<p><span class="math display">\[
\min_{\mathbf{m}} \;\; \frac{1}{2}\|\mathbf{A}\,\mathbf{m} - \mathbf{d}\|_2^2 + \frac{\lambda}{2}\|\mathbf{m}\|_2^2
\]</span></p>
<div class="fragment">
<p>Setting the gradient to zero yields the <strong>damped least-squares</strong> solution:</p>
<p><span class="math display">\[
\boxed{\hat{\mathbf{m}}_{\lambda} = \left(\mathbf{A}^\top\mathbf{A} + \lambda\,\mathbf{I}\right)^{-1}\mathbf{A}^\top\,\mathbf{d}}
\]</span></p>
</div>
<div class="fragment">
<p>In terms of the SVD, the filter factors become:</p>
<p><span class="math display">\[
f_i = \frac{\sigma_i^2}{\sigma_i^2 + \lambda}
\]</span></p>
<p>so each component is damped rather than truncated.</p>
</div>
</section>
<section id="tikhonov-as-an-augmented-system" class="slide level2 smaller">
<h2>Tikhonov as an Augmented System</h2>
<p>The Tikhonov objective</p>
<p><span class="math display">\[
\min_{\mathbf{m}} \;\; \frac{1}{2}\|\mathbf{A}\,\mathbf{m} - \mathbf{d}\|_2^2 + \frac{\lambda}{2}\|\mathbf{m}\|_2^2
\]</span></p>
<p>is equivalent to a <strong>single least-squares problem</strong> with an augmented system:</p>
<p><span class="math display">\[
\min_{\mathbf{m}} \;\; \left\|
\begin{bmatrix} \mathbf{A} \\ \sqrt{\lambda}\,\mathbf{I} \end{bmatrix} \mathbf{m} -
\begin{bmatrix} \mathbf{d} \\ \mathbf{0} \end{bmatrix}
\right\|_2^2
\]</span></p>
<div class="fragment">
<p>Defining <span class="math inline">\(\tilde{\mathbf{A}} = \begin{bmatrix} \mathbf{A} \\ \sqrt{\lambda}\,\mathbf{I} \end{bmatrix}\)</span> and <span class="math inline">\(\tilde{\mathbf{d}} = \begin{bmatrix} \mathbf{d} \\ \mathbf{0} \end{bmatrix}\)</span>, verify that the normal equations <span class="math inline">\(\tilde{\mathbf{A}}^\top\tilde{\mathbf{A}}\,\mathbf{m} = \tilde{\mathbf{A}}^\top\tilde{\mathbf{d}}\)</span> give: <span class="math inline">\(\left(\mathbf{A}^\top\mathbf{A} + \lambda\,\mathbf{I}\right)\mathbf{m} = \mathbf{A}^\top\mathbf{d}\)</span>.</p>
</div>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Why this matters</strong></p>
</div>
<div class="callout-content">
<p>This formulation turns regularized inversion into a standard overdetermined least-squares problem. Solvers like LSQR work directly on the augmented system ‚Äî no need to form <span class="math inline">\(\mathbf{A}^\top\mathbf{A}\)</span> explicitly. The <code>damp</code> parameter in LSQR is precisely <span class="math inline">\(\sqrt{\lambda}\)</span>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="tikhonov-general-form" class="slide level2 smaller">
<h2>Tikhonov ‚Äî General Form</h2>
<p>The <strong>generalized Tikhonov</strong> functional:</p>
<p><span class="math display">\[
\min_{\mathbf{m}} \;\; \frac{1}{2}\|\mathbf{A}\,\mathbf{m} - \mathbf{d}\|_2^2 + \frac{\lambda}{2}\|\mathbf{L}\,\mathbf{m}\|_2^2
\]</span></p>
<div class="fragment">
<p>where <span class="math inline">\(\mathbf{L}\)</span> is a regularization operator:</p>
<table class="caption-top">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><span class="math inline">\(\mathbf{L}\)</span></th>
<th style="text-align: left;">Effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\mathbf{I}\)</span></td>
<td style="text-align: left;">Minimum norm (zeroth-order Tikhonov)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\mathbf{D}_1\)</span> (first difference)</td>
<td style="text-align: left;">Penalize roughness ‚Äî prefer flat models</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\mathbf{D}_2\)</span> (second difference)</td>
<td style="text-align: left;">Penalize curvature ‚Äî prefer smooth models</td>
</tr>
</tbody>
</table>
</div>
<div class="fragment">
<p>Corresponds to</p>
<p><span class="math display">\[
\min_{\mathbf{m}} \;\; \left\|
\begin{bmatrix} \mathbf{A} \\ \sqrt{\lambda}\,\mathbf{L} \end{bmatrix} \mathbf{m} -
\begin{bmatrix} \mathbf{d} \\ \mathbf{0} \end{bmatrix}
\right\|_2^2
\]</span></p>
<p><strong>Solution:</strong> <span class="math inline">\(\hat{\mathbf{m}}_{\lambda} = \left(\mathbf{A}^\top\mathbf{A} + \lambda\,\mathbf{L}^\top\mathbf{L}\right)^{-1}\mathbf{A}^\top\,\mathbf{d}\)</span></p>
</div>
</section>
<section id="regularization-as-a-biasvariance-trade-off" class="slide level2 smaller">
<h2>Regularization as a Bias‚ÄìVariance Trade-off</h2>
<p><span class="math display">\[
\text{MSE}(\hat{\mathbf{m}}) = \underbrace{\|\text{bias}\|^2}_{\text{increases with } \lambda} + \underbrace{\text{variance}}_{\text{decreases with } \lambda}
\]</span></p>
<div class="fragment">
<ul>
<li><strong>No regularization</strong> (<span class="math inline">\(\lambda = 0\)</span>): zero bias, high variance ‚Üí unstable, noisy</li>
<li><strong>Heavy regularization</strong> (<span class="math inline">\(\lambda \to \infty\)</span>): high bias, zero variance ‚Üí oversmoothed</li>
<li><strong>Optimal</strong> <span class="math inline">\(\lambda\)</span>: balances the two</li>
</ul>
</div>
<div class="fragment">
<p><strong>Methods for choosing</strong> <span class="math inline">\(\lambda\)</span>:</p>
<ul>
<li>L-curve criterion</li>
<li>Discrepancy principle: <span class="math inline">\(\|\mathbf{A}\hat{\mathbf{m}} - \mathbf{d}\| \approx \|\mathbf{n}\|\)</span></li>
</ul>
</div>
</section>
<section id="the-l-curve-criterion" class="slide level2">
<h2>The L-Curve Criterion</h2>
<p>Plot <span class="math inline">\(\|\hat{\mathbf{m}}_\lambda\|_2\)</span> vs.&nbsp;<span class="math inline">\(\|\mathbf{A}\hat{\mathbf{m}}_\lambda - \mathbf{d}\|_2\)</span> on a log-log scale as <span class="math inline">\(\lambda\)</span> varies:</p>

<img data-src="figs/l-curve.svg" class="quarto-figure quarto-figure-center r-stretch" style="width:65.0%"><p>The <strong>corner of the L</strong> marks the optimal <span class="math inline">\(\lambda\)</span> ‚Äî the point of maximum curvature where the trade-off between fitting the data and controlling the solution norm is most favorable.</p>
</section>
<section id="bayesian-interpretation" class="slide level2 smaller">
<h2>Bayesian Interpretation</h2>
<p>Rewrite Tikhonov regularization as <strong>maximum a posteriori (MAP)</strong> estimation:</p>
<p><span class="math display">\[
\hat{\mathbf{m}}_{\text{MAP}} = \arg\max_{\mathbf{m}} \; p(\mathbf{m} \mid \mathbf{d}) \propto p(\mathbf{d} \mid \mathbf{m})\,p(\mathbf{m})
\]</span></p>
<div class="fragment">
<p>With Gaussian assumptions:</p>
<ul>
<li><strong>Likelihood:</strong> <span class="math inline">\(p(\mathbf{d} \mid \mathbf{m}) \propto \exp\!\left(-\frac{1}{2}(\mathbf{d} - \mathbf{A}\mathbf{m})^\top\mathbf{C}_d^{-1}(\mathbf{d} - \mathbf{A}\mathbf{m})\right)\)</span></li>
<li><strong>Prior:</strong> <span class="math inline">\(p(\mathbf{m}) \propto \exp\!\left(-\frac{1}{2}\mathbf{m}^\top\mathbf{C}_m^{-1}\mathbf{m}\right)\)</span></li>
</ul>
</div>
<div class="fragment">
<p>Taking <span class="math inline">\(-\log\)</span> recovers a generalized Tikhonov problem:</p>
<p><span class="math display">\[
\min_{\mathbf{m}} \;\; \frac{1}{2}\|\mathbf{C}_d^{-1/2}(\mathbf{A}\mathbf{m} - \mathbf{d})\|_2^2 + \frac{1}{2}\|\mathbf{C}_m^{-1/2}\mathbf{m}\|_2^2
\]</span></p>
<p>where <span class="math inline">\(\mathbf{C}_d\)</span> and <span class="math inline">\(\mathbf{C}_m\)</span> are data and model covariance matrices.</p>
</div>
</section>
<section id="covariance-and-factored-regularization" class="slide level2 smaller">
<h2>Covariance and Factored Regularization</h2>
<p>Factor the inverse covariances:</p>
<p><span class="math display">\[
\mathbf{C}_d^{-1} = \mathbf{W}_d^\top\mathbf{W}_d, \qquad \mathbf{C}_m^{-1} = \mathbf{W}_m^\top\mathbf{W}_m
\]</span></p>
<div class="fragment">
<p>The MAP solution becomes:</p>
<p><span class="math display">\[
\hat{\mathbf{m}} = \left(\mathbf{A}^\top\mathbf{W}_d^\top\mathbf{W}_d\mathbf{A} + \mathbf{W}_m^\top\mathbf{W}_m\right)^{-1}\mathbf{A}^\top\mathbf{W}_d^\top\mathbf{W}_d\,\mathbf{d}
\]</span></p>
</div>
<div class="fragment">
<p><strong>Connections:</strong></p>
<table class="caption-top">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Statistical quantity</th>
<th style="text-align: left;">Regularization quantity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\mathbf{C}_d^{-1}\)</span></td>
<td style="text-align: left;">Data weighting</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\mathbf{C}_m^{-1}\)</span></td>
<td style="text-align: left;">Model penalty (= <span class="math inline">\(\lambda\,\mathbf{L}^\top\mathbf{L}\)</span>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\mathbf{C}_m^{-1/2}\)</span></td>
<td style="text-align: left;">Square root of model precision</td>
</tr>
</tbody>
</table>
</div>
</section></section>
<section>
<section id="part-v-application" class="title-slide slide level1 center" data-background-color="#2c3e50">
<h1>Part V ‚Äî Application</h1>

</section>
<section id="deconvolution-the-setup" class="slide level2 smaller">
<h2>Deconvolution ‚Äî The Setup</h2>

<img data-src="figs/deconvolution.svg" class="quarto-figure quarto-figure-center r-stretch" style="width:120.0%"><p>A sparse reflectivity <span class="math inline">\(r(t)\)</span> convolved with a bandlimited Ricker wavelet <span class="math inline">\(w(t)\)</span> produces the observed trace <span class="math inline">\(d(t)\)</span>. The wavelet spectrum <span class="math inline">\(|W(f)|\)</span> shows the <strong>bandpass</strong> character ‚Äî frequencies near zero and above ~60 Hz carry no signal, making inversion ill-posed.</p>
</section>
<section id="deconvolution-as-an-inverse-problem" class="slide level2 smaller">
<h2>Deconvolution as an Inverse Problem</h2>
<p>A seismic trace is modeled as a <strong>convolution</strong>:</p>
<p><span class="math display">\[
d(t) = w(t) * r(t) + n(t)
\]</span></p>
<ul>
<li><span class="math inline">\(w(t)\)</span>: source wavelet</li>
<li><span class="math inline">\(r(t)\)</span>: reflectivity series</li>
<li><span class="math inline">\(n(t)\)</span>: noise</li>
</ul>
<div class="fragment">
<p>In matrix form:</p>
<p><span class="math display">\[
\mathbf{d} = \mathbf{W}\,\mathbf{r} + \mathbf{n}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{W}\)</span> is a <strong>Toeplitz convolution matrix</strong> built from the wavelet.</p>
</div>
<div class="fragment">
<p><strong>Deconvolution</strong> = inversion for <span class="math inline">\(\mathbf{r}\)</span> given <span class="math inline">\(\mathbf{d}\)</span> and <span class="math inline">\(\mathbf{W}\)</span>.</p>
</div>
</section>
<section id="the-toeplitz-convolution-matrix" class="slide level2 smaller">
<h2>The Toeplitz Convolution Matrix</h2>
<p>Convolution <span class="math inline">\(d_k = \sum_j w_{k-j}\,r_j\)</span> written as a matrix‚Äìvector product:</p>
<p><span class="math display">\[
\begin{bmatrix} d_1 \\ d_2 \\ d_3 \\ d_4 \\ d_5 \\ \vdots \end{bmatrix}
=
\begin{bmatrix}
w_0 &amp; 0 &amp; 0 &amp; \cdots \\
w_1 &amp; w_0 &amp; 0 &amp; \cdots \\
w_2 &amp; w_1 &amp; w_0 &amp; \cdots \\
0 &amp; w_2 &amp; w_1 &amp; \cdots \\
0 &amp; 0 &amp; w_2 &amp; \cdots \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots
\end{bmatrix}
\begin{bmatrix} r_1 \\ r_2 \\ r_3 \\ \vdots \end{bmatrix}
\]</span></p>
<div class="fragment">
<p><strong>Why Toeplitz?</strong> Because the system is <strong>time-invariant</strong> ‚Äî shifting <span class="math inline">\(r\)</span> by one sample shifts <span class="math inline">\(d\)</span> by one sample. Each column of <span class="math inline">\(\mathbf{W}\)</span> is the wavelet, shifted down by one row. This means every descending diagonal is constant, which is the defining property of a Toeplitz matrix.</p>
</div>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Computational consequence</strong></p>
</div>
<div class="callout-content">
<p>A Toeplitz matrix‚Äìvector product is a convolution and costs <span class="math inline">\(\mathcal{O}(N \log N)\)</span> via the FFT, not <span class="math inline">\(\mathcal{O}(NM)\)</span>. This is what makes matrix-free seismic operators practical.</p>
</div>
</div>
</div>
</div>
</section>
<section id="deconvolution-why-its-ill-posed" class="slide level2 smaller">
<h2>Deconvolution ‚Äî Why It‚Äôs Ill-Posed</h2>
<p>The wavelet <span class="math inline">\(w(t)\)</span> is <strong>bandlimited</strong>, so:</p>
<ul>
<li><span class="math inline">\(\mathbf{W}\)</span> has <strong>rapidly decaying singular values</strong></li>
<li>Low and high-frequency reflectivity components are attenuated</li>
<li>Inversion amplifies noise at those frequencies</li>
</ul>
<div class="fragment">
<p>Regularized deconvolution:</p>
<p><span class="math display">\[
\hat{\mathbf{r}} = \left(\mathbf{W}^\top\mathbf{W} + \lambda\,\mathbf{I}\right)^{-1}\mathbf{W}^\top\mathbf{d}
\]</span></p>
</div>
<div class="fragment">
<p><strong>In the Fourier domain</strong> (circulant approximation):</p>
<p><span class="math display">\[
\hat{R}(f) = \frac{\overline{W}(f)}{|W(f)|^2 + \lambda}\,D(f)
\]</span></p>
<p>This is the <strong>Wiener filter</strong>.</p>
</div>
</section>
<section id="numerical-examples-in-julia" class="slide level2">
<h2>Numerical Examples in Julia</h2>
<p>Set up matrix-free operators using <a href="https://github.com/slimgroup/JOLI.jl">JOLI.jl</a>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a></a><span class="im">using</span> <span class="bu">JOLI</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb1-2"><a></a></span>
<span id="cb1-3"><a></a><span class="co"># Define a convolution operator (matrix-free)</span></span>
<span id="cb1-4"><a></a>n <span class="op">=</span> <span class="fl">256</span></span>
<span id="cb1-5"><a></a>w <span class="op">=</span> <span class="fu">ricker</span>(n, <span class="fl">25.0</span>)  <span class="co"># Ricker wavelet, 25 Hz</span></span>
<span id="cb1-6"><a></a>W <span class="op">=</span> <span class="fu">joConvolve</span>(n, w)  <span class="co"># JOLI linear operator</span></span>
<span id="cb1-7"><a></a></span>
<span id="cb1-8"><a></a><span class="co"># W acts like a matrix but stores only the wavelet</span></span>
<span id="cb1-9"><a></a><span class="co"># W  * r  ‚Üí forward (convolution)</span></span>
<span id="cb1-10"><a></a><span class="co"># W' * d  ‚Üí adjoint (correlation)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="fragment">
<p>The adjoint <code>W'</code> is defined to satisfy <span class="math inline">\(\langle \mathbf{W}\mathbf{r}, \mathbf{d}\rangle = \langle \mathbf{r}, \mathbf{W}^\top\mathbf{d}\rangle\)</span>.</p>
</div>
</section>
<section id="julia-solving-with-lsqr" class="slide level2">
<h2>Julia ‚Äî Solving with LSQR</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a></a><span class="im">using</span> <span class="bu">IterativeSolvers</span></span>
<span id="cb2-2"><a></a></span>
<span id="cb2-3"><a></a><span class="co"># True reflectivity</span></span>
<span id="cb2-4"><a></a>r_true <span class="op">=</span> <span class="fu">zeros</span>(n)</span>
<span id="cb2-5"><a></a>r_true[<span class="fl">64</span>]  <span class="op">=</span>  <span class="fl">1.0</span></span>
<span id="cb2-6"><a></a>r_true[<span class="fl">128</span>] <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span></span>
<span id="cb2-7"><a></a>r_true[<span class="fl">192</span>] <span class="op">=</span>  <span class="fl">0.7</span></span>
<span id="cb2-8"><a></a></span>
<span id="cb2-9"><a></a><span class="co"># Noisy data</span></span>
<span id="cb2-10"><a></a>d <span class="op">=</span> W <span class="op">*</span> r_true <span class="op">+</span> <span class="fl">0.05</span> <span class="op">*</span> <span class="fu">randn</span>(n)</span>
<span id="cb2-11"><a></a></span>
<span id="cb2-12"><a></a><span class="co"># Damped least-squares via LSQR</span></span>
<span id="cb2-13"><a></a>r_est <span class="op">=</span> <span class="fu">lsqr</span>(W, d; damp<span class="op">=</span><span class="fl">0.1</span>, maxiter<span class="op">=</span><span class="fl">50</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="fragment">
<p>The <code>damp</code> parameter corresponds to <span class="math inline">\(\sqrt{\lambda}\)</span> in the Tikhonov formulation:</p>
<p><span class="math display">\[
\min_{\mathbf{r}} \;\; \|\mathbf{W}\mathbf{r} - \mathbf{d}\|_2^2 + \lambda\|\mathbf{r}\|_2^2
\]</span></p>
</div>
</section>
<section id="summary" class="slide level2 smaller">
<h2>Summary</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Key concepts:</strong></p>
<ul>
<li>Forward vs.&nbsp;inverse problems</li>
<li>Least-squares &amp; normal equations</li>
<li>SVD and fundamental subspaces</li>
<li>Pseudo-inverse ‚Äî unifies all cases</li>
<li>Regularization as bias‚Äìvariance trade-off</li>
</ul>
</div><div class="column" style="width:50%;">
<p><strong>Practical takeaways:</strong></p>
<ul>
<li>Always assess the <strong>condition number</strong></li>
<li>Use <strong>matrix-free</strong> operators in large-scale problems</li>
<li>Choose regularization via <strong>L-curve</strong> or <strong>discrepancy principle</strong></li>
<li>The Bayesian view gives a <strong>probabilistic interpretation</strong> of regularization</li>
<li>Deconvolution illustrates all key ideas</li>
</ul>
</div></div>
</section>
<section id="references" class="slide level2 smaller">
<h2>References</h2>
<ul>
<li>Aster, R.C., Borchers, B. &amp; Thurber, C.H. <em>Parameter Estimation and Inverse Problems</em>. Academic Press.</li>
<li>Menke, W. <em>Geophysical Data Analysis: Discrete Inverse Theory</em>. Academic Press.</li>
<li>Tarantola, A. <em>Inverse Problem Theory and Methods for Model Parameter Estimation</em>. SIAM. <!-- - Hansen, P.C. *Rank-Deficient and Discrete Ill-Posed Problems*. SIAM.
- Strang, G. *Linear Algebra and Its Applications*. Cengage. --></li>
</ul>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../images/logo.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://flexie.github.io/EAS-8803-FH/">üîó https://flexie.github.io/EAS-88-3-FH</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'bottom-right',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'h.v',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'default',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/flexie\.github\.io\/EAS-8803-FH\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>